import{g as P,r as v,u as j,h as E,i as F,j as b,k as q,t as B,s as O,l as w,m as R,o as L,a as t,w as o,n as U,b as $,p as D,d as c,q as d,v as s,x as H,y as x,z as V,A as S,e as g,B as J,C as z,D as M,E as W,F as G,_ as K}from"./index-B6pBBKko.js";function Q(r){return async(n,e)=>{const l={method:r,headers:{"Content-Type":"application/json"}};return e&&(l.body=JSON.stringify(e)),fetch(n,l).then(X)}}async function X(r){return r.text().then(n=>{const e=n&&JSON.parse(n);if(!r.ok){const l=e&&e.message||r.statusText;return Promise.reject(l)}return e})}const Y={post:Q("POST")},Z={AUTHENTICATOR:"/authenticate"};class ee{static async login(n){try{return Y.post(Z.AUTHENTICATOR,n)}catch(e){console.log(e)}}}const ae={class:"d-flex justify-center"},te=P({__name:"LoginPage",setup(r){const n=v(!1),{t:e}=j(),l=E(),u=v(!1),T=F({email:b().required().email().label("Email"),password:b().required().label("Password")}),{defineField:f,errors:_,handleSubmit:k}=q({validationSchema:B(T)}),[m,C]=f("email"),[p,A]=f("password"),h=k(async y=>{try{u.value=!0;const a=await ee.login(y);a&&(localStorage.setItem("email",a.email),localStorage.setItem("firstName",a.firstName),localStorage.setItem("token",a.token),setTimeout(async()=>{u.value=!1,await l.push("/dashboard")},1500))}catch(a){console.log(a),O("Đăng nhập không thành công!","error")}});return(y,a)=>{const I=w("base-change-language"),N=w("base-dialog-loading");return L(),R(G,null,[t(M,{class:"wrap-login d-flex align-center justify-center",onSubmit:z(s(h),["prevent"])},{default:o(()=>[t(U,{class:"pa-6",elevation:"8","max-width":"400"},{default:o(()=>[t(D,{class:"text-center text-h3"},{default:o(()=>[c(d(s(e)("login")),1)]),_:1}),t(H,null,{default:o(()=>[t(x,V({modelValue:s(m),"onUpdate:modelValue":a[0]||(a[0]=i=>S(m)?m.value=i:null)},s(C),{label:"Email",variant:"outlined","prepend-inner-icon":"mdi-email",type:"email","error-messages":s(_).email}),null,16,["modelValue","error-messages"]),t(x,V({class:"mt-1",modelValue:s(p),"onUpdate:modelValue":a[1]||(a[1]=i=>S(p)?p.value=i:null)},s(A),{label:s(e)("password"),variant:"outlined",type:n.value?"text":"password","prepend-inner-icon":"mdi-lock","append-inner-icon":n.value?"mdi-eye":"mdi-eye-off","onClick:appendInner":a[2]||(a[2]=i=>n.value=!n.value),"error-messages":s(_).password}),null,16,["modelValue","label","type","append-inner-icon","error-messages"]),t(g,{type:"submit",block:"",color:"primary",class:"mt-4",onClick:s(h)},{default:o(()=>[c(d(s(e)("login")),1)]),_:1},8,["onClick"])]),_:1}),t(J,{class:"justify-center"},{default:o(()=>[t(g,{variant:"text",color:"secondary"},{default:o(()=>[c(d(s(e)("register")),1)]),_:1}),t(g,{variant:"text",color:"secondary"},{default:o(()=>[c(d(s(e)("forgotPass")),1)]),_:1})]),_:1}),$("div",ae,[t(I)])]),_:1})]),_:1},8,["onSubmit"]),t(W),t(N,{isLoading:u.value,title:"Đang đăng nhập..."},null,8,["isLoading"])],64)}}}),ne=K(te,[["__scopeId","data-v-2b5ac6fd"]]);export{ne as default};
